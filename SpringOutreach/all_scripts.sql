CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);

START TRANSACTION;

CREATE TABLE "Position" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Title" text NULL,
    CONSTRAINT "PK_Position" PRIMARY KEY ("Id")
);

CREATE TABLE "Status" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Name" text NULL,
    CONSTRAINT "PK_Status" PRIMARY KEY ("Id")
);

CREATE TABLE "Type" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Title" text NULL,
    CONSTRAINT "PK_Type" PRIMARY KEY ("Id")
);

CREATE TABLE "Place" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Name" text NULL,
    "City" text NULL,
    "Canton" text NULL,
    "Adress" text NULL,
    "PlaceNote" text NULL,
    "PlaceConnection" text NULL,
    "PlaceTypeId" integer NULL,
    CONSTRAINT "PK_Place" PRIMARY KEY ("Id"),
    CONSTRAINT "FK_Place_Type_PlaceTypeId" FOREIGN KEY ("PlaceTypeId") REFERENCES "Type" ("Id")
);

CREATE TABLE "Contact" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Name" text NULL,
    "Mail" text NULL,
    "Phone" text NULL,
    "ResponsibleFor" text NULL,
    "PositionId" integer NULL,
    "PlaceId" integer NOT NULL,
    CONSTRAINT "PK_Contact" PRIMARY KEY ("Id"),
    CONSTRAINT "FK_Contact_Place_PlaceId" FOREIGN KEY ("PlaceId") REFERENCES "Place" ("Id") ON DELETE CASCADE,
    CONSTRAINT "FK_Contact_Position_PositionId" FOREIGN KEY ("PositionId") REFERENCES "Position" ("Id")
);

CREATE TABLE "Outreach" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "InternContact" text NULL,
    "InternResponsible" text NULL,
    "StringId" text NULL,
    "Year" integer NULL,
    "Note" text NULL,
    "StartDate" timestamp with time zone NULL,
    "EndDate" timestamp with time zone NULL,
    "PlaceId" integer NULL,
    "StatusId" integer NULL,
    CONSTRAINT "PK_Outreach" PRIMARY KEY ("Id"),
    CONSTRAINT "FK_Outreach_Place_PlaceId" FOREIGN KEY ("PlaceId") REFERENCES "Place" ("Id"),
    CONSTRAINT "FK_Outreach_Status_StatusId" FOREIGN KEY ("StatusId") REFERENCES "Status" ("Id")
);

CREATE TABLE "PlaceLink" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Link" text NULL,
    "PlaceId" integer NULL,
    CONSTRAINT "PK_PlaceLink" PRIMARY KEY ("Id"),
    CONSTRAINT "FK_PlaceLink_Place_PlaceId" FOREIGN KEY ("PlaceId") REFERENCES "Place" ("Id")
);

CREATE TABLE "SecondaryContact" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Name" text NULL,
    "Mail" text NULL,
    "Phone" text NULL,
    "ResponsibleFor" text NULL,
    "SecondaryContactPositionId" integer NULL,
    "StringId" text NULL,
    "PlaceId" integer NOT NULL,
    CONSTRAINT "PK_SecondaryContact" PRIMARY KEY ("Id"),
    CONSTRAINT "FK_SecondaryContact_Place_PlaceId" FOREIGN KEY ("PlaceId") REFERENCES "Place" ("Id") ON DELETE CASCADE,
    CONSTRAINT "FK_SecondaryContact_Position_SecondaryContactPositionId" FOREIGN KEY ("SecondaryContactPositionId") REFERENCES "Position" ("Id")
);

CREATE TABLE "Event" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Title" text NULL,
    "Note" text NULL,
    "Date" timestamp with time zone NULL,
    "OutreachId" integer NULL,
    "Contact" text NULL,
    "StringId" text NULL,
    "Time" text NULL,
    "IsInputRequired" text NULL,
    CONSTRAINT "PK_Event" PRIMARY KEY ("Id"),
    CONSTRAINT "FK_Event_Outreach_OutreachId" FOREIGN KEY ("OutreachId") REFERENCES "Outreach" ("Id")
);

CREATE TABLE "PdfFile" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "FileBytes" bytea NULL,
    "FileName" text NULL,
    "OutreachId" integer NULL,
    CONSTRAINT "PK_PdfFile" PRIMARY KEY ("Id"),
    CONSTRAINT "FK_PdfFile_Outreach_OutreachId" FOREIGN KEY ("OutreachId") REFERENCES "Outreach" ("Id")
);

INSERT INTO "Position" ("Id", "Title")
VALUES (1, 'Jugendarbeiter/inn');
INSERT INTO "Position" ("Id", "Title")
VALUES (2, 'Pfarrer/inn');

INSERT INTO "Status" ("Id", "Name")
VALUES (1, 'Open');
INSERT INTO "Status" ("Id", "Name")
VALUES (2, 'Asked');
INSERT INTO "Status" ("Id", "Name")
VALUES (3, 'Accepted');

INSERT INTO "Type" ("Id", "Title")
VALUES (1, 'Ref');
INSERT INTO "Type" ("Id", "Title")
VALUES (2, 'Kath');

INSERT INTO "Place" ("Id", "Adress", "Canton", "City", "Name", "PlaceConnection", "PlaceNote", "PlaceTypeId")
VALUES (1, 'Burgfeldweg 13', 'Bern', 'Thun', 'Jahu Thun', NULL, NULL, 1);
INSERT INTO "Place" ("Id", "Adress", "Canton", "City", "Name", "PlaceConnection", "PlaceNote", "PlaceTypeId")
VALUES (2, 'Klosterweg 12', 'Zug', 'Zug', 'Oasis Zug', NULL, NULL, 2);

INSERT INTO "Contact" ("Id", "Mail", "Name", "Phone", "PlaceId", "PositionId", "ResponsibleFor")
VALUES (1, 'christina.wenger@jahu.info', 'Christina Wenger', '078 941 66 02', 1, 2, NULL);
INSERT INTO "Contact" ("Id", "Mail", "Name", "Phone", "PlaceId", "PositionId", "ResponsibleFor")
VALUES (2, 'magdalene.soundso@oasis.ch', 'Magdalene Soundso', '079 777 02 32', 2, 1, NULL);

INSERT INTO "Outreach" ("Id", "EndDate", "InternContact", "InternResponsible", "Note", "PlaceId", "StartDate", "StatusId", "StringId", "Year")
VALUES (1, NULL, 'Nicola Beck', 'Eleosa Zürcher', 'Wir haben das und das gemacht.', 1, NULL, 1, 'stringId', 2021);
INSERT INTO "Outreach" ("Id", "EndDate", "InternContact", "InternResponsible", "Note", "PlaceId", "StartDate", "StatusId", "StringId", "Year")
VALUES (2, NULL, 'Micha Wenger', 'Elina Josi', 'Diese Jahr haben wir etwas anders gemacht.', 1, NULL, 2, 'stringId1', 2022);
INSERT INTO "Outreach" ("Id", "EndDate", "InternContact", "InternResponsible", "Note", "PlaceId", "StartDate", "StatusId", "StringId", "Year")
VALUES (3, NULL, 'Janis Volz', 'Sophia Krebs', 'Hier haben wir das getan.', 2, NULL, 2, 'stringId2', 2021);
INSERT INTO "Outreach" ("Id", "EndDate", "InternContact", "InternResponsible", "Note", "PlaceId", "StartDate", "StatusId", "StringId", "Year")
VALUES (4, NULL, 'Simon Schmidt', 'Marlene Roth', 'Und im nächsten Jahr das', 2, NULL, 3, 'stringId3', 2022);

INSERT INTO "SecondaryContact" ("Id", "Mail", "Name", "Phone", "PlaceId", "ResponsibleFor", "SecondaryContactPositionId", "StringId")
VALUES (1, 'micha.wenger@jahu.info', 'Micha Wenger', '078 324 23 02', 1, NULL, 1, 'stringId4');

INSERT INTO "Event" ("Id", "Contact", "Date", "IsInputRequired", "Note", "OutreachId", "StringId", "Time", "Title")
VALUES (1, 'Joëlle Wenger', NULL, NULL, 'Jugendgruppenabend', 1, 'stringId5', NULL, 'LightFactory');

CREATE UNIQUE INDEX "IX_Contact_PlaceId" ON "Contact" ("PlaceId");

CREATE INDEX "IX_Contact_PositionId" ON "Contact" ("PositionId");

CREATE INDEX "IX_Event_OutreachId" ON "Event" ("OutreachId");

CREATE INDEX "IX_Outreach_PlaceId" ON "Outreach" ("PlaceId");

CREATE INDEX "IX_Outreach_StatusId" ON "Outreach" ("StatusId");

CREATE INDEX "IX_PdfFile_OutreachId" ON "PdfFile" ("OutreachId");

CREATE INDEX "IX_Place_PlaceTypeId" ON "Place" ("PlaceTypeId");

CREATE INDEX "IX_PlaceLink_PlaceId" ON "PlaceLink" ("PlaceId");

CREATE INDEX "IX_SecondaryContact_PlaceId" ON "SecondaryContact" ("PlaceId");

CREATE INDEX "IX_SecondaryContact_SecondaryContactPositionId" ON "SecondaryContact" ("SecondaryContactPositionId");

SELECT setval(
    pg_get_serial_sequence('"Position"', 'Id'),
    GREATEST(
        (SELECT MAX("Id") FROM "Position") + 1,
        nextval(pg_get_serial_sequence('"Position"', 'Id'))),
    false);
SELECT setval(
    pg_get_serial_sequence('"Status"', 'Id'),
    GREATEST(
        (SELECT MAX("Id") FROM "Status") + 1,
        nextval(pg_get_serial_sequence('"Status"', 'Id'))),
    false);
SELECT setval(
    pg_get_serial_sequence('"Type"', 'Id'),
    GREATEST(
        (SELECT MAX("Id") FROM "Type") + 1,
        nextval(pg_get_serial_sequence('"Type"', 'Id'))),
    false);
SELECT setval(
    pg_get_serial_sequence('"Place"', 'Id'),
    GREATEST(
        (SELECT MAX("Id") FROM "Place") + 1,
        nextval(pg_get_serial_sequence('"Place"', 'Id'))),
    false);
SELECT setval(
    pg_get_serial_sequence('"Contact"', 'Id'),
    GREATEST(
        (SELECT MAX("Id") FROM "Contact") + 1,
        nextval(pg_get_serial_sequence('"Contact"', 'Id'))),
    false);
SELECT setval(
    pg_get_serial_sequence('"Outreach"', 'Id'),
    GREATEST(
        (SELECT MAX("Id") FROM "Outreach") + 1,
        nextval(pg_get_serial_sequence('"Outreach"', 'Id'))),
    false);
SELECT setval(
    pg_get_serial_sequence('"SecondaryContact"', 'Id'),
    GREATEST(
        (SELECT MAX("Id") FROM "SecondaryContact") + 1,
        nextval(pg_get_serial_sequence('"SecondaryContact"', 'Id'))),
    false);
SELECT setval(
    pg_get_serial_sequence('"Event"', 'Id'),
    GREATEST(
        (SELECT MAX("Id") FROM "Event") + 1,
        nextval(pg_get_serial_sequence('"Event"', 'Id'))),
    false);

INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20230605134237_Init', '7.0.5');

COMMIT;

